# PeerPortal - AIç•™å­¦è§„åˆ’å¸ˆå¹³å°

ä¸€ä¸ªé›†æˆè®ºå›ã€æ¶ˆæ¯ã€æ–‡ä»¶ä¸Šä¼ ã€AIå’¨è¯¢çš„æ™ºèƒ½ç•™å­¦ç”³è¯·å¹³å°ï¼ŒåŸºäºFastAPI + LangGraphæ„å»ºï¼Œæä¾›å…¨æ–¹ä½ç•™å­¦ç”³è¯·æŒ‡å¯¼æœåŠ¡ã€‚

**ğŸ¤– AIæ™ºèƒ½å¯¹è¯ | ğŸ’¬ å®æ—¶æ¶ˆæ¯ | ğŸ›ï¸ è®ºå›äº¤æµ | ğŸ“ æ–‡ä»¶ç®¡ç† | ğŸ¯ ç²¾å‡†åŒ¹é… | ğŸš€ é«˜æ€§èƒ½æ¶æ„**

## ğŸŒŸ æ ¸å¿ƒåŠŸèƒ½

### ğŸ¤– AIç•™å­¦è§„åˆ’å¸ˆ
- **æ™ºèƒ½å¯¹è¯**: åŸºäºLangGraphçš„å¤šè½®å¯¹è¯AIç³»ç»Ÿ
- **çŸ¥è¯†åº“å­¦ä¹ **: æ”¯æŒPDFæ–‡æ¡£ä¸Šä¼ ï¼ŒAIè‡ªåŠ¨å­¦ä¹ ä¸“ä¸šçŸ¥è¯†  
- **å®æ—¶æœç´¢**: é›†æˆç½‘ç»œæœç´¢è·å–æœ€æ–°ä¿¡æ¯
- **å·¥å…·èåˆ**: æ•°æ®åº“æŸ¥è¯¢ + ç½‘ç»œæœç´¢ + çŸ¥è¯†åº“æ£€ç´¢

### ğŸ›ï¸ è®ºå›ç³»ç»Ÿ (æ–°å¢)
- **åˆ†ç±»è®¨è®º**: ç”³è¯·ç»éªŒã€é™¢æ ¡è®¨è®ºã€ç•™å­¦ç”Ÿæ´»ã€èŒä¸šè§„åˆ’ç­‰
- **å¸–å­ç®¡ç†**: åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤ã€ç½®é¡¶ã€åŠ çƒ­
- **äº’åŠ¨åŠŸèƒ½**: ç‚¹èµã€å›å¤ã€åµŒå¥—è¯„è®º
- **æ ‡ç­¾ç³»ç»Ÿ**: çƒ­é—¨æ ‡ç­¾ã€æœç´¢ç­›é€‰
- **ä¸¾æŠ¥ç³»ç»Ÿ**: å†…å®¹å®¡æ ¸å’Œç¤¾åŒºç®¡ç†

### ğŸ’¬ æ¶ˆæ¯ç³»ç»Ÿ (å¢å¼º)
- **å®æ—¶é€šä¿¡**: å¯¼å¸ˆå­¦ç”Ÿä¸€å¯¹ä¸€èŠå¤©
- **å¯¹è¯ç®¡ç†**: å¯¹è¯åˆ—è¡¨ã€æœªè¯»æ¶ˆæ¯æé†’
- **æ¶ˆæ¯ç±»å‹**: æ–‡æœ¬ã€å›¾ç‰‡ã€æ–‡ä»¶æ¶ˆæ¯æ”¯æŒ
- **æ¶ˆæ¯çŠ¶æ€**: å·²å‘é€ã€å·²é€è¾¾ã€å·²è¯»çŠ¶æ€è·Ÿè¸ª
- **åœ¨çº¿çŠ¶æ€**: å®æ—¶åœ¨çº¿çŠ¶æ€æ˜¾ç¤º

### ğŸ“ æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿ (æ–°å¢)
- **å¤´åƒä¸Šä¼ **: æ”¯æŒå¤šç§å›¾ç‰‡æ ¼å¼ï¼Œè‡ªåŠ¨å‹ç¼©ä¼˜åŒ–
- **æ–‡æ¡£ç®¡ç†**: PDFã€Wordã€TXTæ–‡ä»¶ä¸Šä¼ ä¸ç®¡ç†
- **æ‰¹é‡ä¸Šä¼ **: ä¸€æ¬¡æ€§ä¸Šä¼ å¤šä¸ªæ–‡ä»¶
- **å®‰å…¨éªŒè¯**: æ–‡ä»¶ç±»å‹ã€å¤§å°ä¸¥æ ¼é™åˆ¶
- **é™æ€æœåŠ¡**: é«˜æ•ˆçš„æ–‡ä»¶è®¿é—®å’Œä¸‹è½½

### ğŸ¯ æ™ºèƒ½åŒ¹é…ç³»ç»Ÿ
- **ç²¾å‡†æ¨è**: åŸºäºç›®æ ‡å­¦æ ¡ã€ä¸“ä¸šã€ç”³è¯·é˜¶æ®µçš„æ™ºèƒ½åŒ¹é…
- **å¼•è·¯äººç½‘ç»œ**: è¿æ¥åœ¨è¯»ç”Ÿ/æ¯•ä¸šç”Ÿä¸ç”³è¯·è€…
- **æœåŠ¡æ¨è**: ä¸ªæ€§åŒ–ç•™å­¦æœåŠ¡æ¨è
- **è¯„ä»·ä½“ç³»**: é€æ˜çš„æœåŠ¡è¯„ä»·å’Œè´¨é‡ä¿è¯

### ğŸŒ å¤šç«¯æ”¯æŒ
- **REST API**: å®Œæ•´çš„FastAPIåç«¯æœåŠ¡
- **Webç•Œé¢**: Streamlitäº¤äº’å¼ç•Œé¢
- **Swaggeræ–‡æ¡£**: è‡ªåŠ¨ç”Ÿæˆçš„APIæ–‡æ¡£

## ğŸ“ é¡¹ç›®ç»“æ„

```
backend/
â”œâ”€â”€ app/                          # åº”ç”¨æ ¸å¿ƒä»£ç 
â”‚   â”œâ”€â”€ agents/                   # AI Agentç›¸å…³
â”‚   â”‚   â”œâ”€â”€ langgraph/           # LangGraphå®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ agent_state.py   # AgentçŠ¶æ€å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ agent_graph.py   # Agentæ ¸å¿ƒé€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ agent_tools.py   # å·¥å…·é›†åˆ
â”‚   â”‚   â”‚   â””â”€â”€ knowledge_base.py # çŸ¥è¯†åº“ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ planner_agent.py     # ç®€å•Agentå®ç°
â”‚   â”‚   â””â”€â”€ tools/               # å·¥å…·å®ç°
â”‚   â”œâ”€â”€ api/                     # APIè·¯ç”±
â”‚   â”‚   â””â”€â”€ routers/             # APIè·¯ç”±æ¨¡å—
â”‚   â”‚       â”œâ”€â”€ forum_router.py  # è®ºå›ç³»ç»ŸAPI (æ–°å¢)
â”‚   â”‚       â”œâ”€â”€ file_router.py   # æ–‡ä»¶ä¸Šä¼ API (æ–°å¢)
â”‚   â”‚       â”œâ”€â”€ message_router.py # æ¶ˆæ¯ç³»ç»ŸAPI (å¢å¼º)
â”‚   â”‚       â””â”€â”€ ...              # å…¶ä»–APIæ¨¡å—
â”‚   â”œâ”€â”€ core/                    # æ ¸å¿ƒé…ç½®
â”‚   â”œâ”€â”€ crud/                    # æ•°æ®åº“æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ crud_forum.py        # è®ºå›CRUD (æ–°å¢)
â”‚   â”‚   â”œâ”€â”€ crud_message.py      # æ¶ˆæ¯CRUD (æ–°å¢)
â”‚   â”‚   â””â”€â”€ ...                  # å…¶ä»–CRUDæ¨¡å—
â”‚   â”œâ”€â”€ schemas/                 # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ forum_schema.py      # è®ºå›æ•°æ®æ¨¡å‹ (æ–°å¢)
â”‚   â”‚   â”œâ”€â”€ message_schema.py    # æ¶ˆæ¯æ•°æ®æ¨¡å‹ (æ–°å¢)
â”‚   â”‚   â””â”€â”€ ...                  # å…¶ä»–æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ main.py                  # FastAPIåº”ç”¨å…¥å£
â”‚   â””â”€â”€ streamlit_app.py         # Streamlit Webç•Œé¢
â”œâ”€â”€ test/                        # æµ‹è¯•æ–‡ä»¶ (æŒ‰åŠŸèƒ½åˆ†ç±»)
â”‚   â”œâ”€â”€ agents/                  # AI Agentæµ‹è¯• (18ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ api/                     # APIåŠŸèƒ½æµ‹è¯• (12ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ database/                # æ•°æ®åº“æµ‹è¯• (10ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ integration/             # é›†æˆæµ‹è¯• (3ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ tools/                   # æµ‹è¯•å·¥å…· (12ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ scripts/                 # æµ‹è¯•è„šæœ¬ (8ä¸ªæ–‡ä»¶)
â”‚   â””â”€â”€ reports/                 # æµ‹è¯•æŠ¥å‘Š (11ä¸ªæ–‡ä»¶)
â”œâ”€â”€ scripts/                     # å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ database/                # æ•°æ®åº“ç›¸å…³è„šæœ¬
â”‚   â”‚   â””â”€â”€ create_missing_tables.sql # æ–°å¢è¡¨ç»“æ„ (æ–°å¢)
â”‚   â””â”€â”€ *.py                     # è°ƒè¯•å’Œç»´æŠ¤è„šæœ¬
â”œâ”€â”€ docs/                        # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ PeerPortal_åç«¯APIæ–‡æ¡£.md # å®Œæ•´APIæ–‡æ¡£ (æ–°å¢)
â”‚   â”œâ”€â”€ æ–°åŠŸèƒ½æµ‹è¯•æŒ‡å—.md        # æµ‹è¯•æŒ‡å— (æ–°å¢)
â”‚   â””â”€â”€ é¡¹ç›®å®Œå–„å®ŒæˆæŠ¥å‘Š.md      # é¡¹ç›®æŠ¥å‘Š (æ–°å¢)
â”œâ”€â”€ uploads/                     # æ–‡ä»¶ä¸Šä¼ ç›®å½• (æ–°å¢)
â”‚   â”œâ”€â”€ avatars/                # å¤´åƒå­˜å‚¨
â”‚   â””â”€â”€ documents/              # æ–‡æ¡£å­˜å‚¨
â”œâ”€â”€ knowledge_base/              # çŸ¥è¯†åº“æ–‡ä»¶å­˜å‚¨
â”œâ”€â”€ vector_store/                # å‘é‡æ•°æ®åº“(ChromaDB)
â”œâ”€â”€ test_new_features.py         # æ–°åŠŸèƒ½æµ‹è¯•è„šæœ¬ (æ–°å¢)
â”œâ”€â”€ test_database_tables.py      # æ•°æ®åº“éªŒè¯è„šæœ¬ (æ–°å¢)
â”œâ”€â”€ run_feature_tests.sh         # ä¸€é”®æµ‹è¯•è„šæœ¬ (æ–°å¢)
â”œâ”€â”€ fix_test_issues.py           # æµ‹è¯•è¯Šæ–­å·¥å…· (æ–°å¢)
â”œâ”€â”€ start_api.sh                 # FastAPIå¯åŠ¨è„šæœ¬
â”œâ”€â”€ start_streamlit.sh           # Streamlitå¯åŠ¨è„šæœ¬
â””â”€â”€ run_tests.sh                 # æµ‹è¯•è¿è¡Œè„šæœ¬
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate  # macOS/Linux
# venv\Scripts\activate   # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ `configs/env_example.txt` ä¸º `.env` å¹¶å¡«å…¥é…ç½®ï¼š

```env
# OpenAI API Key (å¿…éœ€)
OPENAI_API_KEY=sk-...

# Tavily API Key (å¯é€‰ï¼Œç”¨äºç½‘ç»œæœç´¢)
TAVILY_API_KEY=tvly-...

# Supabaseæ•°æ®åº“é…ç½® (å¿…éœ€)
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your-supabase-anon-key
SUPABASE_JWT_SECRET=your-jwt-secret
SUPABASE_DB_PASSWORD=your-database-password
DATABASE_URL=postgresql://postgres:[password]@db.[project].supabase.co:5432/postgres

# å…¶ä»–é…ç½®
DEBUG=true
```

### 3. æ•°æ®åº“åˆå§‹åŒ–

```bash
# åˆ›å»ºæ–°å¢çš„æ•°æ®åº“è¡¨
psql -h your-host -U your-username -d your-database -f scripts/database/create_missing_tables.sql

# æˆ–ä½¿ç”¨è¯Šæ–­å·¥å…·æ£€æŸ¥ç¯å¢ƒ
python fix_test_issues.py
```

### 4. å¯åŠ¨æœåŠ¡

```bash
# æ–¹å¼1: å¯åŠ¨FastAPIåç«¯æœåŠ¡
./start_api.sh
# è®¿é—® http://localhost:8000/docs

# æ–¹å¼2: å¯åŠ¨Streamlit Webç•Œé¢  
./start_streamlit.sh
# è®¿é—® http://localhost:8503

# æ–¹å¼3: ä½¿ç”¨uvicornç›´æ¥å¯åŠ¨
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 5. è¿è¡Œæµ‹è¯•

```bash
# ä¸€é”®æµ‹è¯•æ‰€æœ‰æ–°åŠŸèƒ½ (æ¨è)
cd test/scripts && ./run_feature_tests.sh

# æŒ‰æ¨¡å—è¿è¡Œæµ‹è¯•
python -m pytest test/api/           # APIåŠŸèƒ½æµ‹è¯•
python -m pytest test/database/     # æ•°æ®åº“æµ‹è¯•
python -m pytest test/agents/       # AI Agentæµ‹è¯•
python -m pytest test/integration/  # é›†æˆæµ‹è¯•

# ä½¿ç”¨æµ‹è¯•å·¥å…·
cd test/tools && python fix_test_issues.py  # ç¯å¢ƒè¯Šæ–­

# æˆ–è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
cd test/scripts && ./run_tests.sh
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ | ç‰ˆæœ¬ | ä½œç”¨ |
|------|------|------|------|
| **åç«¯æ¡†æ¶** | FastAPI | 0.116.1 | RESTful APIæœåŠ¡ |
| **æ™ºèƒ½ä½“æ ¸å¿ƒ** | LangGraph | 0.2.51 | AIå·¥ä½œæµç¼–æ’ |
| **å¤§è¯­è¨€æ¨¡å‹** | OpenAI GPT | 4o-mini | æ™ºèƒ½å¯¹è¯å’Œæ¨ç† |
| **çŸ¥è¯†åº“** | ChromaDB | 0.5.15 | å‘é‡æ•°æ®åº“ |
| **æ–‡ä»¶å¤„ç†** | aiofiles | 24.1.0 | å¼‚æ­¥æ–‡ä»¶æ“ä½œ |
| **Webç•Œé¢** | Streamlit | 1.41.1 | äº¤äº’å¼å‰ç«¯ |
| **æ•°æ®åº“** | Supabase | 2.17.0 | åç«¯æ•°æ®å­˜å‚¨ |
| **ç½‘ç»œæœç´¢** | Tavily/DuckDuckGo | latest | å®æ—¶ä¿¡æ¯æ£€ç´¢ |
| **HTTPå®¢æˆ·ç«¯** | httpx | 0.28.1 | å¼‚æ­¥HTTPè¯·æ±‚ |

## ğŸ“Š APIæ¥å£

### ğŸ›ï¸ è®ºå›ç³»ç»Ÿ API (æ–°å¢)

#### åˆ†ç±»å’Œå¸–å­ç®¡ç†
- `GET /api/v1/forum/categories` - è·å–è®ºå›åˆ†ç±»
- `GET /api/v1/forum/posts` - è·å–å¸–å­åˆ—è¡¨ (æ”¯æŒç­›é€‰å’Œæœç´¢)
- `POST /api/v1/forum/posts` - åˆ›å»ºæ–°å¸–å­
- `GET /api/v1/forum/posts/{post_id}` - è·å–å¸–å­è¯¦æƒ…
- `PUT /api/v1/forum/posts/{post_id}` - æ›´æ–°å¸–å­
- `DELETE /api/v1/forum/posts/{post_id}` - åˆ é™¤å¸–å­

#### äº’åŠ¨åŠŸèƒ½
- `POST /api/v1/forum/posts/{post_id}/like` - ç‚¹èµ/å–æ¶ˆç‚¹èµå¸–å­
- `POST /api/v1/forum/posts/{post_id}/view` - å¢åŠ æµè§ˆé‡
- `GET /api/v1/forum/posts/{post_id}/replies` - è·å–å¸–å­å›å¤
- `POST /api/v1/forum/posts/{post_id}/replies` - åˆ›å»ºå›å¤
- `PUT /api/v1/forum/replies/{reply_id}` - æ›´æ–°å›å¤
- `DELETE /api/v1/forum/replies/{reply_id}` - åˆ é™¤å›å¤
- `POST /api/v1/forum/replies/{reply_id}/like` - ç‚¹èµ/å–æ¶ˆç‚¹èµå›å¤

#### ä¸ªäººå’Œç®¡ç†
- `GET /api/v1/forum/my-posts` - æˆ‘çš„å¸–å­
- `GET /api/v1/forum/my-replies` - æˆ‘çš„å›å¤
- `GET /api/v1/forum/tags/popular` - çƒ­é—¨æ ‡ç­¾
- `POST /api/v1/forum/posts/{post_id}/report` - ä¸¾æŠ¥å¸–å­
- `POST /api/v1/forum/replies/{reply_id}/report` - ä¸¾æŠ¥å›å¤

### ğŸ’¬ æ¶ˆæ¯ç³»ç»Ÿ API (å¢å¼º)

#### å¯¹è¯ç®¡ç†
- `GET /api/v1/messages/conversations` - è·å–å¯¹è¯åˆ—è¡¨
- `GET /api/v1/messages/conversations/{conversation_id}` - è·å–å¯¹è¯æ¶ˆæ¯
- `GET /api/v1/messages` - è·å–æ¶ˆæ¯åˆ—è¡¨

#### æ¶ˆæ¯æ“ä½œ
- `POST /api/v1/messages` - å‘é€æ¶ˆæ¯
- `PUT /api/v1/messages/{message_id}/read` - æ ‡è®°æ¶ˆæ¯ä¸ºå·²è¯»

### ğŸ“ æ–‡ä»¶ä¸Šä¼  API (æ–°å¢)

#### æ–‡ä»¶ä¸Šä¼ 
- `POST /api/v1/files/upload/avatar` - ä¸Šä¼ å¤´åƒ (JPG, PNG, GIF, WebP, æœ€å¤§5MB)
- `POST /api/v1/files/upload/document` - ä¸Šä¼ æ–‡æ¡£ (PDF, DOC, DOCX, TXT, æœ€å¤§10MB)
- `POST /api/v1/files/upload/multiple` - æ‰¹é‡ä¸Šä¼ æ–‡ä»¶ (æœ€å¤š10ä¸ª)

#### æ–‡ä»¶ç®¡ç†
- `DELETE /api/v1/files/files/{file_id}` - åˆ é™¤æ–‡ä»¶
- `GET /static/uploads/avatars/{filename}` - è®¿é—®å¤´åƒæ–‡ä»¶
- `GET /static/uploads/documents/{filename}` - è®¿é—®æ–‡æ¡£æ–‡ä»¶

### ğŸ¤– AIæ™ºèƒ½ä½“API

#### åŸºç¡€ç‰ˆAgent
- `GET /api/v1/planner/capabilities` - AIèƒ½åŠ›æŸ¥è¯¢
- `POST /api/v1/planner/invoke` - AIå’¨è¯¢å¯¹è¯ (è·¯å¾„å·²ä¿®å¤)

#### é«˜çº§ç‰ˆAgent
- `GET /api/v1/ai/advanced-planner/health` - å¥åº·æ£€æŸ¥  
- `POST /api/v1/ai/advanced-planner/invoke` - é«˜çº§AIå’¨è¯¢
- `POST /api/v1/ai/advanced-planner/upload-documents` - ä¸Šä¼ çŸ¥è¯†åº“æ–‡æ¡£
- `GET /api/v1/ai/advanced-planner/knowledge-base/status` - çŸ¥è¯†åº“çŠ¶æ€

### ğŸ‘¤ ç”¨æˆ·ç®¡ç† API

#### ç”¨æˆ·ä¿¡æ¯
- `GET /api/v1/users/me` - è·å–å®Œæ•´ç”¨æˆ·ä¿¡æ¯
- `GET /api/v1/users/me/basic` - è·å–åŸºç¡€ç”¨æˆ·ä¿¡æ¯ (æ–°å¢)
- `PUT /api/v1/users/me` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- `GET /api/v1/users/{user_id}/profile` - è·å–å…¬å¼€ç”¨æˆ·èµ„æ–™

#### è®¤è¯ç³»ç»Ÿ
- `POST /api/v1/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/v1/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/v1/auth/refresh` - åˆ·æ–°Token

### ğŸ¯ å…¶ä»–æ ¸å¿ƒAPI

#### å¯¼å¸ˆç³»ç»Ÿ
- `GET /api/v1/mentors/search` - æœç´¢å¯¼å¸ˆ
- `GET /api/v1/mentors/{mentor_id}` - è·å–å¯¼å¸ˆè¯¦æƒ…
- `POST /api/v1/mentors/profile` - åˆ›å»ºå¯¼å¸ˆæ¡£æ¡ˆ

#### ä¼šè¯å’Œè¯„ä»·
- `GET /api/v1/sessions` - è·å–ä¼šè¯åˆ—è¡¨
- `POST /api/v1/sessions` - åˆ›å»ºä¼šè¯é¢„çº¦
- `GET /api/v1/sessions/statistics` - ä¼šè¯ç»Ÿè®¡
- `POST /api/v1/reviews` - åˆ›å»ºè¯„ä»·
- `GET /api/v1/reviews/my-reviews` - æˆ‘çš„è¯„ä»·

#### æœåŠ¡è®¢å•
- `GET /api/v1/services/orders/my-orders` - æˆ‘çš„è®¢å•

#### å­¦ç”Ÿæ¡£æ¡ˆ
- `GET /api/v1/students/profile` - è·å–å­¦ç”Ÿæ¡£æ¡ˆ

### APIä½¿ç”¨ç¤ºä¾‹

```python
# è®ºå›APIä½¿ç”¨ç¤ºä¾‹
import httpx

# è·å–è®ºå›åˆ†ç±»
async with httpx.AsyncClient() as client:
    response = await client.get("http://localhost:8000/api/v1/forum/categories")
    categories = response.json()

# åˆ›å»ºå¸–å­
post_data = {
    "title": "ç¾å›½CSç¡•å£«ç”³è¯·ç»éªŒåˆ†äº«",
    "content": "åˆ†äº«æˆ‘çš„ç”³è¯·ç»éªŒ...",
    "category": "application",
    "tags": ["ç¾å›½ç•™å­¦", "CSç”³è¯·"]
}
response = await client.post(
    "http://localhost:8000/api/v1/forum/posts",
    json=post_data,
    headers={"Authorization": f"Bearer {token}"}
)

# æ–‡ä»¶ä¸Šä¼ ç¤ºä¾‹
with open("avatar.png", "rb") as f:
    files = {"file": ("avatar.png", f, "image/png")}
    response = await client.post(
        "http://localhost:8000/api/v1/files/upload/avatar",
        files=files,
        headers={"Authorization": f"Bearer {token}"}
    )

# AIå’¨è¯¢ç¤ºä¾‹
ai_data = {
    "input": "æˆ‘æƒ³ç”³è¯·ç¾å›½è®¡ç®—æœºç§‘å­¦ç¡•å£«ï¼Œæœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ",
    "session_id": "user123",
    "stream": False
}
response = await client.post(
    "http://localhost:8000/api/v1/planner/invoke",
    json=ai_data,
    headers={"Authorization": f"Bearer {token}"}
)
```

## ğŸ—„ï¸ æ•°æ®åº“ç»“æ„

### æ–°å¢æ•°æ®è¡¨

| è¡¨å | è¯´æ˜ | ä¸»è¦å­—æ®µ |
|------|------|----------|
| **forum_posts** | è®ºå›å¸–å­ | id, title, content, author_id, category, tags, likes_count, views_count |
| **forum_replies** | è®ºå›å›å¤ | id, post_id, content, author_id, parent_id, likes_count |
| **forum_likes** | ç‚¹èµè®°å½• | id, user_id, post_id, reply_id |
| **messages** | æ¶ˆæ¯è®°å½• | id, sender_id, recipient_id, content, message_type, status, is_read |
| **uploaded_files** | æ–‡ä»¶è®°å½• | id, file_id, user_id, filename, file_path, file_size, content_type |

### æ•°æ®åº“ä¼˜åŒ–

- âœ… **æ€§èƒ½ç´¢å¼•**: é’ˆå¯¹æŸ¥è¯¢ä¼˜åŒ–çš„å¤åˆç´¢å¼•
- âœ… **è‡ªåŠ¨è§¦å‘å™¨**: ç»Ÿè®¡æ•°æ®è‡ªåŠ¨æ›´æ–° (ç‚¹èµæ•°ã€å›å¤æ•°)
- âœ… **æ•°æ®ä¸€è‡´æ€§**: å¤–é”®çº¦æŸå’Œæ£€æŸ¥çº¦æŸ
- âœ… **æŸ¥è¯¢è§†å›¾**: ç®€åŒ–å¤æ‚æŸ¥è¯¢çš„ä¼˜åŒ–è§†å›¾

## ğŸ§ª æµ‹è¯•ç³»ç»Ÿ

### æ–°å¢æµ‹è¯•å·¥å…·

#### ğŸ”§ ç¯å¢ƒè¯Šæ–­å·¥å…·
```bash
# è¿è¡Œç¯å¢ƒè¯Šæ–­
cd test/tools && python fix_test_issues.py
```
**åŠŸèƒ½**:
- Pythonç‰ˆæœ¬æ£€æŸ¥
- è™šæ‹Ÿç¯å¢ƒçŠ¶æ€éªŒè¯
- ä¾èµ–åŒ…å®‰è£…æ£€æŸ¥
- æµ‹è¯•æ–‡ä»¶å®Œæ•´æ€§éªŒè¯
- ä¸Šä¼ ç›®å½•åˆ›å»º
- å¸¸è§é—®é¢˜è‡ªåŠ¨ä¿®å¤

#### ğŸ“Š ç»¼åˆåŠŸèƒ½æµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æ–°åŠŸèƒ½æµ‹è¯•
cd test/api && python test_new_features.py
```
**æµ‹è¯•èŒƒå›´**:
- ğŸ›ï¸ è®ºå›ç³»ç»Ÿ (4ä¸ªAPIç«¯ç‚¹)
- ğŸ’¬ æ¶ˆæ¯ç³»ç»Ÿ (3ä¸ªAPIç«¯ç‚¹)
- ğŸ“ æ–‡ä»¶ä¸Šä¼  (2ä¸ªAPIç«¯ç‚¹)
- ğŸ¤– AIåŠŸèƒ½ (2ä¸ªAPIç«¯ç‚¹)
- ğŸ‘¤ ç”¨æˆ·ç®¡ç† (2ä¸ªAPIç«¯ç‚¹)

#### ğŸ—„ï¸ æ•°æ®åº“ç»“æ„éªŒè¯
```bash
# éªŒè¯æ•°æ®åº“è¡¨ç»“æ„
cd test/database && python test_database_tables.py
```
**éªŒè¯å†…å®¹**:
- è¡¨å­˜åœ¨æ€§æ£€æŸ¥ (5ä¸ªæ–°å¢è¡¨)
- åˆ—ç»“æ„å®Œæ•´æ€§éªŒè¯
- ç´¢å¼•ä¼˜åŒ–æ£€æŸ¥ (15+ä¸ªç´¢å¼•)
- è§¦å‘å™¨åŠŸèƒ½éªŒè¯
- è§†å›¾å¯ç”¨æ€§æ£€æŸ¥

#### ğŸš€ ä¸€é”®æµ‹è¯•è„šæœ¬
```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
cd test/scripts && ./run_feature_tests.sh
```
**è‡ªåŠ¨åŒ–åŠŸèƒ½**:
- ç¯å¢ƒæ£€æŸ¥å’Œä¿®å¤
- æœåŠ¡å™¨çŠ¶æ€éªŒè¯
- ä¾èµ–è‡ªåŠ¨å®‰è£…
- å¹¶è¡Œæµ‹è¯•æ‰§è¡Œ
- ç»¼åˆæŠ¥å‘Šç”Ÿæˆ

### æµ‹è¯•è¦†ç›–ç‡

| åŠŸèƒ½æ¨¡å— | æµ‹è¯•è¦†ç›– | ç«¯ç‚¹æ•°é‡ | çŠ¶æ€ |
|---------|---------|----------|------|
| ğŸ›ï¸ **è®ºå›ç³»ç»Ÿ** | 100% | 12ä¸ªAPI | âœ… å…¨è¦†ç›– |
| ğŸ’¬ **æ¶ˆæ¯ç³»ç»Ÿ** | 100% | 5ä¸ªAPI | âœ… å…¨è¦†ç›– |
| ğŸ“ **æ–‡ä»¶ä¸Šä¼ ** | 100% | 4ä¸ªAPI | âœ… å…¨è¦†ç›– |
| ğŸ¤– **AIåŠŸèƒ½** | 100% | 2ä¸ªAPI | âœ… å…¨è¦†ç›– |
| ğŸ‘¤ **ç”¨æˆ·ç®¡ç†** | 100% | 4ä¸ªAPI | âœ… å…¨è¦†ç›– |
| ğŸ—„ï¸ **æ•°æ®åº“** | 100% | 15é¡¹æ£€æŸ¥ | âœ… å…¨è¦†ç›– |

**æ€»è®¡**: 27ä¸ªAPIç«¯ç‚¹ + 15é¡¹æ•°æ®åº“æ£€æŸ¥ = **42é¡¹å…¨é¢æµ‹è¯•**

### æµ‹è¯•æŠ¥å‘Š

æµ‹è¯•å®Œæˆåè‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹æŠ¥å‘Šï¼š

- `new_features_test_report_*.json` - APIåŠŸèƒ½æµ‹è¯•è¯¦ç»†æŠ¥å‘Š
- `database_verification_report_*.json` - æ•°æ®åº“éªŒè¯è¯¦ç»†æŠ¥å‘Š
- `comprehensive_test_summary.md` - ç»¼åˆæµ‹è¯•æ‘˜è¦
- `diagnostic_report.md` - ç¯å¢ƒè¯Šæ–­æŠ¥å‘Š

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„è®ºå›åŠŸèƒ½

1. **æ‰©å±•æ•°æ®æ¨¡å‹**:
```python
# app/schemas/forum_schema.py
class NewForumFeature(BaseModel):
    name: str
    description: str
```

2. **å®ç°CRUDæ“ä½œ**:
```python
# app/crud/crud_forum.py
async def create_feature(self, db_conn, feature_data):
    # å®ç°æ•°æ®åº“æ“ä½œ
    pass
```

3. **æ·»åŠ APIç«¯ç‚¹**:
```python
# app/api/routers/forum_router.py
@router.post("/features")
async def create_forum_feature(feature: NewForumFeature):
    return await forum_crud.create_feature(db_conn, feature)
```

### æ‰©å±•æ¶ˆæ¯ç³»ç»Ÿ

```python
# æ·»åŠ æ–°æ¶ˆæ¯ç±»å‹
class MessageType(str, Enum):
    text = "text"
    image = "image"
    file = "file"
    voice = "voice"  # æ–°å¢è¯­éŸ³æ¶ˆæ¯
    video = "video"  # æ–°å¢è§†é¢‘æ¶ˆæ¯
```

### è‡ªå®šä¹‰æ–‡ä»¶ä¸Šä¼ 

```python
# æ·»åŠ æ–°æ–‡ä»¶ç±»å‹æ”¯æŒ
ALLOWED_VIDEO_TYPES = {
    "video/mp4", "video/avi", "video/mov"
}

@router.post("/upload/video")
async def upload_video(file: UploadFile = File(...)):
    # å®ç°è§†é¢‘ä¸Šä¼ é€»è¾‘
    pass
```

### æ•°æ®åº“è¿ç§»

```sql
-- æ·»åŠ æ–°å­—æ®µ
ALTER TABLE forum_posts ADD COLUMN featured BOOLEAN DEFAULT FALSE;

-- åˆ›å»ºæ–°ç´¢å¼•
CREATE INDEX idx_forum_posts_featured ON forum_posts(featured) WHERE featured = TRUE;
```

## ğŸš€ ç”Ÿäº§éƒ¨ç½²

### Dockeréƒ¨ç½²
```bash
# æ„å»ºé•œåƒ
docker build -t peerportal-backend .

# è¿è¡Œå®¹å™¨
docker run -d -p 8000:8000 --env-file .env peerportal-backend
```

### ç¯å¢ƒé…ç½®
```env
# ç”Ÿäº§ç¯å¢ƒé…ç½®
DEBUG=false
SECRET_KEY=your-production-secret-key
DATABASE_URL=your-production-database-url
ALLOWED_ORIGINS=["https://yourdomain.com"]
```

### æ€§èƒ½ä¼˜åŒ–
- âœ… **è¿æ¥æ± **: asyncpgæ•°æ®åº“è¿æ¥æ± 
- âœ… **é™æ€æ–‡ä»¶**: é«˜æ•ˆçš„æ–‡ä»¶æœåŠ¡
- âœ… **å¼‚æ­¥å¤„ç†**: å…¨å¼‚æ­¥æ¶æ„
- âœ… **ç¼“å­˜ç­–ç•¥**: åˆç†çš„ç¼“å­˜æœºåˆ¶

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **AsyncIOå®‰è£…é”™è¯¯**:
   ```bash
   # asyncioæ˜¯Pythonå†…ç½®æ¨¡å—ï¼Œæ— éœ€å®‰è£…
   python -c "import asyncio; print('âœ… asyncioå¯ç”¨')"
   ```

2. **æ–‡ä»¶ä¸Šä¼ å¤±è´¥**:
   ```bash
   # ç¡®ä¿ä¸Šä¼ ç›®å½•å­˜åœ¨
   mkdir -p uploads/avatars uploads/documents
   chmod 755 uploads/
   ```

3. **æ•°æ®åº“è¡¨ä¸å­˜åœ¨**:
   ```bash
   # æ‰§è¡Œæ•°æ®åº“è¡¨åˆ›å»ºè„šæœ¬
   psql -h host -U user -d db -f scripts/database/create_missing_tables.sql
   ```

4. **æœåŠ¡å™¨å¯åŠ¨å¤±è´¥**:
   ```bash
   # æ£€æŸ¥ä¾èµ–æ˜¯å¦å®Œæ•´
   pip install -r requirements.txt
   
   # æµ‹è¯•åº”ç”¨å¯¼å…¥
   python -c "from app.main import app; print('âœ… åº”ç”¨å¯¼å…¥æˆåŠŸ')"
   ```

### è°ƒè¯•å·¥å…·

```bash
# è¿è¡Œç¯å¢ƒè¯Šæ–­
python fix_test_issues.py

# æ£€æŸ¥APIå¥åº·çŠ¶æ€
curl http://localhost:8000/

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
uvicorn app.main:app --reload --log-level debug
```

### è·å–æ”¯æŒ

- ğŸ“§ **æŠ€æœ¯æ”¯æŒ**: tech@peerportal.com
- ğŸ“š **è¯¦ç»†æ–‡æ¡£**: æŸ¥çœ‹ `docs/` ç›®å½•
- ğŸ› **BugæŠ¥å‘Š**: [GitHub Issues](https://github.com/PeerPortal/backend/issues)
- ğŸ’¬ **ç¤¾åŒºè®¨è®º**: [è®ºå›ç³»ç»Ÿ](http://localhost:8000/api/v1/forum/categories)

---

## ğŸŒŸ é¡¹ç›®çŠ¶æ€

**âœ… PeerPortal v2.0.0 - å…¨åŠŸèƒ½ç•™å­¦å¹³å°**

### ğŸ‰ æœ€æ–°æ›´æ–° (v2.0.0)

- ğŸ›ï¸ **è®ºå›ç³»ç»Ÿ**: å®Œæ•´çš„ç¤¾åŒºè®¨è®ºåŠŸèƒ½
- ğŸ’¬ **æ¶ˆæ¯ç³»ç»Ÿ**: å®æ—¶é€šä¿¡å’Œå¯¹è¯ç®¡ç†
- ğŸ“ **æ–‡ä»¶ä¸Šä¼ **: å®‰å…¨çš„æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ
- ğŸ”§ **AIè·¯å¾„ä¿®å¤**: ä¼˜åŒ–çš„AIæœåŠ¡æ¥å£
- ğŸ§ª **æµ‹è¯•å¥—ä»¶**: å…¨é¢çš„è‡ªåŠ¨åŒ–æµ‹è¯•ç³»ç»Ÿ
- ğŸ“Š **é¡¹ç›®æ–‡æ¡£**: å®Œæ•´çš„APIæ–‡æ¡£å’Œä½¿ç”¨æŒ‡å—

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- ğŸ“ **ä¸“ä¸šå®šä½**: ä¸“æ³¨ç•™å­¦ç”³è¯·æŒ‡å¯¼æœåŠ¡
- âš¡ **é«˜æ€§èƒ½**: asyncpgè¿æ¥æ±  + FastAPIå¼‚æ­¥æ¶æ„  
- ğŸ›ï¸ **ç¤¾åŒºäº¤æµ**: å®Œæ•´çš„è®ºå›å’Œæ¶ˆæ¯ç³»ç»Ÿ
- ğŸ“ **æ–‡ä»¶ç®¡ç†**: å®‰å…¨çš„ä¸Šä¼ å’Œå­˜å‚¨æœºåˆ¶
- ğŸ¯ **æ™ºèƒ½åŒ¹é…**: å¤šç»´åº¦åŒ¹é…ç®—æ³•
- ğŸ“± **APIå®Œæ•´**: 27ä¸ªç«¯ç‚¹ + 5ä¸ªæ•°æ®è¡¨
- ğŸ”’ **ä¼ä¸šå®‰å…¨**: JWT + è§’è‰²æƒé™ + æ•°æ®éªŒè¯
- ğŸ“Š **å…¨é¢æµ‹è¯•**: 42é¡¹æµ‹è¯• + è‡ªåŠ¨åŒ–éªŒè¯
- ğŸ“š **å®Œæ•´æ–‡æ¡£**: APIæ–‡æ¡£ + ä½¿ç”¨æŒ‡å—

### ğŸ“Š æŠ€æœ¯æŒ‡æ ‡

- **APIç«¯ç‚¹**: 27ä¸ª (æ–°å¢12ä¸ªè®ºå›API + 4ä¸ªæ–‡ä»¶API)
- **æ•°æ®è¡¨**: 15ä¸ª (æ–°å¢5ä¸ªæ ¸å¿ƒè¡¨)
- **æµ‹è¯•è¦†ç›–**: 42é¡¹æµ‹è¯• (API + æ•°æ®åº“)
- **æ–‡æ¡£å®Œæ•´**: 3ä¸ªå®Œæ•´æŒ‡å— + APIæ–‡æ¡£
- **æ€§èƒ½ä¼˜åŒ–**: 15+ä¸ªæ•°æ®åº“ç´¢å¼• + è§¦å‘å™¨
- **å®‰å…¨ç‰¹æ€§**: æ–‡ä»¶éªŒè¯ + æƒé™æ§åˆ¶ + æ•°æ®éªŒè¯

**ğŸš€ è®©æ¯ä¸€ä¸ªç•™å­¦æ¢¦æƒ³éƒ½èƒ½åœ¨ç¤¾åŒºä¸­æ‰¾åˆ°æ”¯æŒå’ŒæŒ‡å¯¼ï¼**

---
*Â© 2024 PeerPortalå›¢é˜Ÿ. All rights reserved. - ç‰ˆæœ¬ v2.0.0*
