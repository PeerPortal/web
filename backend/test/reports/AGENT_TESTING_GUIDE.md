# AIç•™å­¦è§„åˆ’å¸ˆAgentæ‰‹åŠ¨æµ‹è¯•æŒ‡å—

## ğŸ¯ æµ‹è¯•ç›®æ ‡

éªŒè¯AIç•™å­¦è§„åˆ’å¸ˆAgentçš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š
- åŸºç¡€å¯¹è¯èƒ½åŠ›
- å·¥å…·è°ƒç”¨é›†æˆ
- LangSmithè¿½è¸ª
- é”™è¯¯å¤„ç†
- å¯¹è¯è¿ç»­æ€§

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆæ¨èï¼‰

```bash
# è¿è¡Œç»¼åˆæµ‹è¯•è„šæœ¬
python test_agent_comprehensive.py

# æˆ–è¿è¡ŒLangSmithé›†æˆæµ‹è¯•
python test_langsmith_integration.py

# è¿è¡Œå¿«é€ŸéªŒè¯è„šæœ¬
./verify_langsmith.sh
```

### 2. å¯åŠ¨APIæœåŠ¡è¿›è¡Œæ‰‹åŠ¨æµ‹è¯•

```bash
# å¯åŠ¨APIæœåŠ¡
uvicorn app.main:app --host 0.0.0.0 --port 8001 --reload

# æˆ–ä½¿ç”¨å¯åŠ¨è„šæœ¬
./start_api.sh
```

æœåŠ¡å¯åŠ¨åè®¿é—®ï¼š
- **APIæ–‡æ¡£**: http://localhost:8001/docs
- **å¥åº·æ£€æŸ¥**: http://localhost:8001/api/v1/advanced-planner/health

---

## ğŸ§ª æ‰‹åŠ¨æµ‹è¯•åœºæ™¯

### åœºæ™¯1: åŸºç¡€ç•™å­¦å’¨è¯¢

**æµ‹è¯•ç›®æ ‡**: éªŒè¯Agentå¯¹åŸºç¡€ç•™å­¦é—®é¢˜çš„å›ç­”èƒ½åŠ›

**APIè°ƒç”¨**:
```bash
curl -X POST "http://localhost:8001/api/v1/advanced-planner/invoke" \
  -H "Content-Type: application/json" \
  -d '{
    "input": "æˆ‘æƒ³ç”³è¯·ç¾å›½çš„è®¡ç®—æœºç§‘å­¦ç¡•å£«ï¼Œéœ€è¦ä»€ä¹ˆæ¡ä»¶ï¼Ÿ",
    "user_id": "test_user_001",
    "session_id": "session_001",
    "chat_history": [],
    "stream": false
  }'
```

**é¢„æœŸç»“æœ**:
- âœ… å“åº”æ—¶é—´ < 10ç§’
- âœ… å›ç­”åŒ…å«å…³é”®ä¿¡æ¯ï¼šGPAè¦æ±‚ã€è¯­è¨€æˆç»©ã€GREã€æ¨èä¿¡ç­‰
- âœ… å›ç­”é•¿åº¦ > 200å­—ç¬¦
- âœ… LangSmithè¿½è¸ªæ­£å¸¸ï¼ˆå¦‚æœå·²é…ç½®ï¼‰

**éªŒè¯è¦ç‚¹**:
- å›ç­”çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§
- æ˜¯å¦åŒ…å«å…·ä½“çš„ç”³è¯·è¦æ±‚
- è¯­è¨€è¡¨è¾¾æ˜¯å¦è‡ªç„¶æµç•…

### åœºæ™¯2: å·¥å…·è°ƒç”¨æµ‹è¯•

**æµ‹è¯•ç›®æ ‡**: éªŒè¯Agentèƒ½æ­£ç¡®è°ƒç”¨å„ç§å·¥å…·

#### 2.1 ç½‘ç»œæœç´¢å·¥å…·
```bash
curl -X POST "http://localhost:8001/api/v1/advanced-planner/invoke" \
  -H "Content-Type: application/json" \
  -d '{
    "input": "2024å¹´æœ€æ–°çš„ç¾å›½å¤§å­¦è®¡ç®—æœºä¸“ä¸šæ’åæ˜¯ä»€ä¹ˆï¼Ÿ",
    "user_id": "test_user_002",
    "session_id": "session_002",
    "stream": false
  }'
```

**é¢„æœŸç»“æœ**:
- âœ… è°ƒç”¨äº†ç½‘ç»œæœç´¢å·¥å…·
- âœ… è¿”å›æœ€æ–°çš„æ’åä¿¡æ¯
- âœ… metadataä¸­tool_calls > 0

#### 2.2 çŸ¥è¯†åº“æœç´¢
```bash
curl -X POST "http://localhost:8001/api/v1/advanced-planner/invoke" \
  -H "Content-Type: application/json" \
  -d '{
    "input": "Spring Bootæ¡†æ¶æœ‰å“ªäº›æ ¸å¿ƒç‰¹æ€§ï¼Ÿ",
    "user_id": "test_user_003",
    "session_id": "session_003",
    "stream": false
  }'
```

**é¢„æœŸç»“æœ**:
- âœ… è°ƒç”¨äº†çŸ¥è¯†åº“æœç´¢å·¥å…·
- âœ… è¿”å›ç›¸å…³çš„æŠ€æœ¯ä¿¡æ¯
- âœ… åŸºäºä¸Šä¼ çš„çŸ¥è¯†åº“æ–‡æ¡£å›ç­”

#### 2.3 æ•°æ®åº“æŸ¥è¯¢
```bash
curl -X POST "http://localhost:8001/api/v1/advanced-planner/invoke" \
  -H "Content-Type: application/json" \
  -d '{
    "input": "æœ‰å“ªäº›è®¡ç®—æœºç§‘å­¦æ–¹é¢çš„å¯¼å¸ˆæˆ–æœåŠ¡ï¼Ÿ",
    "user_id": "test_user_004",
    "session_id": "session_004",
    "stream": false
  }'
```

**é¢„æœŸç»“æœ**:
- âœ… è°ƒç”¨äº†æ•°æ®åº“æŸ¥è¯¢å·¥å…·
- âœ… è¿”å›ç›¸å…³çš„å¯¼å¸ˆæˆ–æœåŠ¡ä¿¡æ¯
- âœ… æ•°æ®æ¥è‡ªSupabaseæ•°æ®åº“

### åœºæ™¯3: å¯¹è¯è¿ç»­æ€§æµ‹è¯•

**æµ‹è¯•ç›®æ ‡**: éªŒè¯Agentèƒ½ç»´æŒå¤šè½®å¯¹è¯çš„ä¸Šä¸‹æ–‡

#### ç¬¬ä¸€è½®å¯¹è¯
```bash
curl -X POST "http://localhost:8001/api/v1/advanced-planner/invoke" \
  -H "Content-Type: application/json" \
  -d '{
    "input": "æˆ‘æƒ³ç”³è¯·ç¾å›½çš„ç ”ç©¶ç”Ÿ",
    "user_id": "continuity_user",
    "session_id": "continuity_session",
    "chat_history": [],
    "stream": false
  }'
```

#### ç¬¬äºŒè½®å¯¹è¯ï¼ˆåŸºäºç¬¬ä¸€è½®çš„å“åº”ï¼‰
```bash
curl -X POST "http://localhost:8001/api/v1/advanced-planner/invoke" \
  -H "Content-Type: application/json" \
  -d '{
    "input": "æˆ‘çš„ä¸“ä¸šæ˜¯è®¡ç®—æœºç§‘å­¦ï¼ŒGPA 3.7",
    "user_id": "continuity_user",
    "session_id": "continuity_session",
    "chat_history": [
      {"role": "user", "content": "æˆ‘æƒ³ç”³è¯·ç¾å›½çš„ç ”ç©¶ç”Ÿ"},
      {"role": "assistant", "content": "ç¬¬ä¸€è½®çš„å›ç­”å†…å®¹"}
    ],
    "stream": false
  }'
```

#### ç¬¬ä¸‰è½®å¯¹è¯
```bash
curl -X POST "http://localhost:8001/api/v1/advanced-planner/invoke" \
  -H "Content-Type: application/json" \
  -d '{
    "input": "ä½ è§‰å¾—æˆ‘åº”è¯¥ç”³è¯·å“ªäº›å­¦æ ¡ï¼Ÿ",
    "user_id": "continuity_user", 
    "session_id": "continuity_session",
    "chat_history": [
      {"role": "user", "content": "æˆ‘æƒ³ç”³è¯·ç¾å›½çš„ç ”ç©¶ç”Ÿ"},
      {"role": "assistant", "content": "ç¬¬ä¸€è½®çš„å›ç­”å†…å®¹"},
      {"role": "user", "content": "æˆ‘çš„ä¸“ä¸šæ˜¯è®¡ç®—æœºç§‘å­¦ï¼ŒGPA 3.7"},
      {"role": "assistant", "content": "ç¬¬äºŒè½®çš„å›ç­”å†…å®¹"}
    ],
    "stream": false
  }'
```

**é¢„æœŸç»“æœ**:
- âœ… Agentèƒ½è®°ä½ä¹‹å‰çš„å¯¹è¯å†…å®¹
- âœ… å›ç­”åŸºäºå‰é¢æä¾›çš„ä¿¡æ¯ï¼ˆä¸“ä¸šã€GPAç­‰ï¼‰
- âœ… ç»™å‡ºä¸ªæ€§åŒ–çš„å­¦æ ¡æ¨è

### åœºæ™¯4: æµå¼å“åº”æµ‹è¯•

**æµ‹è¯•ç›®æ ‡**: éªŒè¯æµå¼å“åº”åŠŸèƒ½

```bash
curl -X POST "http://localhost:8001/api/v1/advanced-planner/invoke" \
  -H "Content-Type: application/json" \
  -d '{
    "input": "è¯·è¯¦ç»†ä»‹ç»ä¸€ä¸‹ç”³è¯·ç¾å›½ç ”ç©¶ç”Ÿçš„å®Œæ•´æµç¨‹",
    "user_id": "stream_user",
    "session_id": "stream_session",
    "stream": true
  }' \
  --no-buffer
```

**é¢„æœŸç»“æœ**:
- âœ… è¿”å›æµå¼æ•°æ®ï¼ˆServer-Sent Eventsæ ¼å¼ï¼‰
- âœ… é€æ­¥è¾“å‡ºå›ç­”å†…å®¹
- âœ… æœ€åå‘é€å®Œæˆä¿¡å·

### åœºæ™¯5: é”™è¯¯å¤„ç†æµ‹è¯•

#### 5.1 ç©ºè¾“å…¥æµ‹è¯•
```bash
curl -X POST "http://localhost:8001/api/v1/advanced-planner/invoke" \
  -H "Content-Type: application/json" \
  -d '{
    "input": "",
    "user_id": "error_user",
    "session_id": "error_session",
    "stream": false
  }'
```

**é¢„æœŸç»“æœ**:
- âœ… è¿”å›400é”™è¯¯æˆ–ä¼˜é›…çš„é”™è¯¯æç¤º
- âœ… ä¸ä¼šå¯¼è‡´æœåŠ¡å´©æºƒ

#### 5.2 è¶…é•¿è¾“å…¥æµ‹è¯•
```bash
curl -X POST "http://localhost:8001/api/v1/advanced-planner/invoke" \
  -H "Content-Type: application/json" \
  -d '{
    "input": "'$(python -c "print('å¾ˆé•¿çš„æµ‹è¯•è¾“å…¥' * 200)")'"",
    "user_id": "error_user",
    "session_id": "error_session",
    "stream": false
  }'
```

**é¢„æœŸç»“æœ**:
- âœ… è¾“å…¥é•¿åº¦éªŒè¯ç”Ÿæ•ˆ
- âœ… è¿”å›é€‚å½“çš„é”™è¯¯ä¿¡æ¯

---

## ğŸ“Š LangSmithç›‘æ§éªŒè¯

### 1. æ£€æŸ¥LangSmith Dashboard

è®¿é—® https://smith.langchain.com å¹¶æ£€æŸ¥ï¼š

- **é¡¹ç›®**: AIç•™å­¦è§„åˆ’å¸ˆ
- **è¿½è¸ªè®°å½•**: æ¯æ¬¡APIè°ƒç”¨éƒ½åº”æœ‰å¯¹åº”çš„trace
- **æ‰§è¡Œæ—¶é—´**: ç›‘æ§å“åº”æ—¶é—´è¶‹åŠ¿
- **å·¥å…·è°ƒç”¨**: æŸ¥çœ‹å·¥å…·ä½¿ç”¨ç»Ÿè®¡
- **é”™è¯¯ç›‘æ§**: æ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸è®°å½•

### 2. æœ¬åœ°è¿½è¸ªéªŒè¯

æ£€æŸ¥ç»ˆç«¯è¾“å‡ºä¸­çš„LangSmithæ—¥å¿—ï¼š
```
ğŸ” [LangSmith] å¼€å§‹è¿½è¸ªAgentè¿è¡Œ - ç”¨æˆ·: test_user_001
âœ… [LangSmith] Agentè¿è¡Œå®Œæˆ - ç”¨æˆ·: test_user_001, æ‰§è¡Œæ—¶é—´: 2.34ç§’
```

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### 1. Agentåˆå§‹åŒ–å¤±è´¥
**ç°è±¡**: 
```
âŒ Agentåˆå§‹åŒ–å¤±è´¥: 'NoneType' object has no attribute...
```

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ `OPENAI_API_KEY` æ˜¯å¦æ­£ç¡®
- éªŒè¯ç½‘ç»œè¿æ¥å’ŒAPIé…é¢
- æ£€æŸ¥ä¾èµ–åŒ…æ˜¯å¦å®Œæ•´å®‰è£…

#### 2. å·¥å…·è°ƒç”¨å¤±è´¥
**ç°è±¡**: 
```
âš ï¸ å·¥å…·è°ƒç”¨å¼‚å¸¸: API key not found
```

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ `TAVILY_API_KEY` é…ç½®
- éªŒè¯ Supabase æ•°æ®åº“è¿æ¥
- æ£€æŸ¥çŸ¥è¯†åº“æ–‡ä»¶æ˜¯å¦å­˜åœ¨

#### 3. LangSmithè¿½è¸ªä¸æ˜¾ç¤º
**ç°è±¡**: 
```
ğŸ” LangSmithçŠ¶æ€: æœªå¯ç”¨
```

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ `LANGCHAIN_TRACING_V2=true`
- éªŒè¯ `LANGCHAIN_API_KEY` æ˜¯å¦æœ‰æ•ˆ
- ç¡®è®¤ `LANGCHAIN_PROJECT` åç§°æ­£ç¡®

#### 4. æ•°æ®åº“è¿æ¥é”™è¯¯
**ç°è±¡**:
```
âŒ æ•°æ®åº“è¿æ¥å¤±è´¥: could not connect to server
```

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ Supabase URL å’Œå¯†é’¥
- éªŒè¯ç½‘ç»œè¿æ¥
- æ£€æŸ¥æ•°æ®åº“æ˜¯å¦æ­£å¸¸è¿è¡Œ

---

## ğŸ“ æµ‹è¯•è®°å½•æ¨¡æ¿

### æµ‹è¯•æ‰§è¡Œè®°å½•

| æµ‹è¯•åœºæ™¯ | æ‰§è¡Œæ—¶é—´ | ç»“æœ | å“åº”æ—¶é—´ | å·¥å…·è°ƒç”¨ | å¤‡æ³¨ |
|---------|---------|------|---------|---------|------|
| åŸºç¡€å’¨è¯¢ | 2024-01-25 | âœ…/âŒ | 2.3s | 1æ¬¡ | |
| ç½‘ç»œæœç´¢ | 2024-01-25 | âœ…/âŒ | 4.1s | 2æ¬¡ | |
| çŸ¥è¯†åº“æŸ¥è¯¢ | 2024-01-25 | âœ…/âŒ | 1.8s | 1æ¬¡ | |
| å¯¹è¯è¿ç»­æ€§ | 2024-01-25 | âœ…/âŒ | 2.1s | 0æ¬¡ | |
| æµå¼å“åº” | 2024-01-25 | âœ…/âŒ | 3.2s | 1æ¬¡ | |

### æ€§èƒ½åŸºå‡†

- **ç›®æ ‡å“åº”æ—¶é—´**: < 5ç§’
- **æˆåŠŸç‡**: > 95%
- **ç”¨æˆ·æ»¡æ„åº¦**: åŸºäºå›ç­”è´¨é‡è¯„ä¼°
- **å·¥å…·è°ƒç”¨æˆåŠŸç‡**: > 90%

---

## ğŸ¯ æµ‹è¯•å®Œæˆæ¸…å•

- [ ] è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬è¿è¡ŒæˆåŠŸ
- [ ] APIæœåŠ¡æ­£å¸¸å¯åŠ¨
- [ ] åŸºç¡€å¯¹è¯åŠŸèƒ½æ­£å¸¸
- [ ] å„ç§å·¥å…·è°ƒç”¨æˆåŠŸ
- [ ] å¯¹è¯è¿ç»­æ€§ç»´æŒè‰¯å¥½
- [ ] æµå¼å“åº”åŠŸèƒ½æ­£å¸¸
- [ ] é”™è¯¯å¤„ç†æœºåˆ¶æœ‰æ•ˆ
- [ ] LangSmithè¿½è¸ªæ­£å¸¸è®°å½•
- [ ] æ€§èƒ½æŒ‡æ ‡ç¬¦åˆé¢„æœŸ
- [ ] ç”¨æˆ·ä½“éªŒæ»¡æ„

---

**ğŸ’¡ æç¤º**: 
- é¦–æ¬¡è¿è¡Œå»ºè®®ä½¿ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬ `python test_agent_comprehensive.py`
- å¦‚éœ€æ·±å…¥æµ‹è¯•ç‰¹å®šåŠŸèƒ½ï¼Œå¯ä½¿ç”¨å¯¹åº”çš„æ‰‹åŠ¨æµ‹è¯•åœºæ™¯
- å»ºè®®åœ¨ä¸åŒç½‘ç»œç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•ä»¥éªŒè¯ç¨³å®šæ€§
- å®šæœŸè¿è¡Œæµ‹è¯•ä»¥ç¡®ä¿åŠŸèƒ½æŒç»­æ­£å¸¸
