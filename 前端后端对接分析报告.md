# ğŸ”— PeerPortal å‰ç«¯åç«¯æ¥å£å¯¹æ¥åˆ†ææŠ¥å‘Š

## ğŸ“Š **å¯¹æ¥ç°çŠ¶æ¦‚è§ˆ**

### âœ… **å·²å®ç°çš„æ¥å£æ¨¡å—**

- **è®¤è¯ç³»ç»Ÿ** (`/api/v1/auth`) - âœ… 90% å®Œæˆ
- **ç”¨æˆ·ç®¡ç†** (`/api/v1/users`) - âœ… 80% å®Œæˆ
- **è®ºå›ç³»ç»Ÿ** (`/api/v1/forum`) - âœ… 95% å®Œæˆ
- **æ¶ˆæ¯ç³»ç»Ÿ** (`/api/v1/messages`) - âœ… 70% å®Œæˆ

### âŒ **å®Œå…¨ç¼ºå¤±çš„æ ¸å¿ƒæ¨¡å—**

- **ğŸ¤– AIæ™ºèƒ½ä½“ç³»ç»Ÿ v2.0** (`/api/v2/agents`) - âŒ **0%**
- **ğŸ¯ æ™ºèƒ½åŒ¹é…ç³»ç»Ÿ** (`/api/v1/matching`) - âŒ **0%**
- **ğŸ“ æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿ** (`/api/v1/files`) - âŒ **0%**

### âš ï¸ **éƒ¨åˆ†å®ç°çš„æ¨¡å—**

- **å­¦é•¿å­¦å§ç®¡ç†** (`/api/v1/mentors`) - âš ï¸ 40% å®Œæˆ
- **å­¦å¼Ÿå­¦å¦¹ç®¡ç†** (`/api/v1/students`) - âš ï¸ 30% å®Œæˆ
- **æŒ‡å¯¼æœåŠ¡ç®¡ç†** (`/api/v1/services`) - âš ï¸ 20% å®Œæˆ
- **ä¼šè¯ç®¡ç†** (`/api/v1/sessions`) - âš ï¸ 30% å®Œæˆ
- **è¯„ä»·ç³»ç»Ÿ** (`/api/v1/reviews`) - âš ï¸ 20% å®Œæˆ

---

## ğŸš¨ **é‡å¤§ç¼ºå¤±è¯¦ç»†åˆ†æ**

### 1. ğŸ¤– **AIæ™ºèƒ½ä½“ç³»ç»Ÿ v2.0** - **æœ€é«˜ä¼˜å…ˆçº§**

#### ç¼ºå¤±æ¥å£ï¼š

```typescript
// å®Œå…¨ç¼ºå¤± - è¿™æ˜¯ç³»ç»Ÿæ ¸å¿ƒåŠŸèƒ½ï¼
/api/2v /
  agents /
  status / // ç³»ç»ŸçŠ¶æ€
  api /
  v2 /
  agents /
  info / // æ¶æ„ä¿¡æ¯
  api /
  v2 /
  agents /
  health / // å¥åº·æ£€æŸ¥
  api /
  v2 /
  agents /
  planner /
  chat / // ç•™å­¦è§„åˆ’å¸ˆå¯¹è¯ â­ï¸
  api /
  v2 /
  agents /
  consultant /
  chat / // ç•™å­¦å’¨è¯¢å¸ˆå¯¹è¯ â­ï¸
  api /
  v2 /
  agents /
  chat; // æ™ºèƒ½ä½“è‡ªåŠ¨é€‰æ‹©
```

#### å½±å“ï¼š

- **æ— æ³•ä½¿ç”¨AIæ™ºèƒ½ä½“åŠŸèƒ½** - è¿™æ˜¯å¹³å°çš„æ ¸å¿ƒå–ç‚¹
- å‰ç«¯å½“å‰ä½¿ç”¨çš„æ˜¯è¿‡æ—¶çš„ `/api/v1/planner/invoke`
- ç”¨æˆ·æ— æ³•ä½“éªŒç•™å­¦è§„åˆ’å¸ˆå’Œå’¨è¯¢å¸ˆåŠŸèƒ½

### 2. ğŸ¯ **æ™ºèƒ½åŒ¹é…ç³»ç»Ÿ** - **é«˜ä¼˜å…ˆçº§**

#### ç¼ºå¤±æ¥å£ï¼š

```typescript
/api/1v /
  matching /
  recommend / // æ¨èå¼•è·¯äºº â­ï¸
  api /
  v1 /
  matching /
  filters / // è·å–ç­›é€‰æ¡ä»¶
  api /
  v1 /
  matching /
  filter / // é«˜çº§ç­›é€‰
  api /
  v1 /
  matching /
  history / // åŒ¹é…å†å²
  api /
  v1 /
  matching /
  save / // ä¿å­˜åŒ¹é…ç»“æœ
  api /
  v1 /
  matching /
  saved / // è·å–æ”¶è—çš„åŒ¹é…
  api /
  v1 /
  matching /
  stats / // åŒ¹é…ç»Ÿè®¡
  api /
  v1 /
  matching /
  compatibility; // å…¼å®¹æ€§æ£€æŸ¥
```

#### å½±å“ï¼š

- **æ— æ³•å®ç°æ™ºèƒ½åŒ¹é…åŠŸèƒ½**
- ç”³è¯·è€…æ— æ³•æ‰¾åˆ°åˆé€‚çš„å¼•è·¯äºº
- ç¼ºå¤±æ ¸å¿ƒä¸šåŠ¡é€»è¾‘

### 3. ğŸ“ **æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿ** - **ä¸­ç­‰ä¼˜å…ˆçº§**

#### ç¼ºå¤±æ¥å£ï¼š

```typescript
/api/1v /
  files /
  upload /
  avatar / // ä¸Šä¼ å¤´åƒ
  api /
  v1 /
  files /
  upload /
  document / // ä¸Šä¼ æ–‡æ¡£
  api /
  v1 /
  files /
  upload /
  general / // é€šç”¨æ–‡ä»¶ä¸Šä¼ 
  api /
  v1 /
  files /
  { file_id }; // åˆ é™¤æ–‡ä»¶
```

#### å½±å“ï¼š

- ç”¨æˆ·æ— æ³•ä¸Šä¼ å¤´åƒå’Œç”³è¯·æ–‡æ¡£
- æ— æ³•å®ç°æ–‡ä»¶ç®¡ç†åŠŸèƒ½

---

## ğŸ”§ **ç¼ºå¤±æ¥å£å®ç°æ–¹æ¡ˆ**

### æ–¹æ¡ˆä¸€ï¼šå¿«é€Ÿä¿®å¤æ ¸å¿ƒåŠŸèƒ½

#### 1. **AIæ™ºèƒ½ä½“ v2.0 APIå®¢æˆ·ç«¯**

```typescript
// web/app/_lib/ai-agent-api.ts
export interface ChatRequest {
  message: string;
  user_id: string;
  session_id?: string;
}

export interface ChatResponse {
  response: string;
  agent_type: string;
  version: string;
  user_id: string;
  session_id?: string;
}

export interface SystemStatusResponse {
  is_initialized: boolean;
  version: string;
  available_agents: string[];
  external_services: Record<string, boolean>;
}

class AIAgentAPI {
  // ä¸ç•™å­¦è§„åˆ’å¸ˆå¯¹è¯
  async chatWithPlanner(request: ChatRequest): Promise<ChatResponse> {
    const response = await apiRequest('/api/v2/agents/planner/chat', {
      method: 'POST',
      body: JSON.stringify(request)
    });
    return response.json();
  }

  // ä¸ç•™å­¦å’¨è¯¢å¸ˆå¯¹è¯
  async chatWithConsultant(request: ChatRequest): Promise<ChatResponse> {
    const response = await apiRequest('/api/v2/agents/consultant/chat', {
      method: 'POST',
      body: JSON.stringify(request)
    });
    return response.json();
  }

  // è·å–ç³»ç»ŸçŠ¶æ€
  async getSystemStatus(): Promise<SystemStatusResponse> {
    const response = await apiRequest('/api/v2/agents/status');
    return response.json();
  }

  // å¥åº·æ£€æŸ¥
  async healthCheck(): Promise<any> {
    const response = await apiRequest('/api/v2/agents/health');
    return response.json();
  }
}

export const aiAgentAPI = new AIAgentAPI();
```

#### 2. **æ™ºèƒ½åŒ¹é…ç³»ç»Ÿ APIå®¢æˆ·ç«¯**

```typescript
// web/app/_lib/matching-api.ts
export interface MatchingRequest {
  target_universities: string[];
  target_majors: string[];
  preferred_degree: string;
  budget_range: [number, number];
  preferred_languages: string[];
  session_type: string;
  timeline: string;
  special_requirements?: string;
}

export interface MatchingResult {
  request_id: string;
  student_id: number;
  total_matches: number;
  matches: MentorMatch[];
  filters_applied: MatchingRequest;
  created_at: string;
}

export interface MentorMatch {
  mentor_id: number;
  mentor_name: string;
  university: string;
  major: string;
  match_score: number;
  match_reasons: string[];
  hourly_rate: number;
  rating: number;
  total_sessions: number;
}

class MatchingAPI {
  // æ¨èå¼•è·¯äºº
  async recommendMentors(request: MatchingRequest): Promise<MatchingResult> {
    const response = await apiRequest('/api/v1/matching/recommend', {
      method: 'POST',
      body: JSON.stringify(request)
    });
    return response.json();
  }

  // è·å–ç­›é€‰æ¡ä»¶
  async getFilters(): Promise<any> {
    const response = await apiRequest('/api/v1/matching/filters');
    return response.json();
  }

  // è·å–åŒ¹é…å†å²
  async getMatchingHistory(): Promise<MatchingResult[]> {
    const response = await apiRequest('/api/v1/matching/history');
    return response.json();
  }

  // ä¿å­˜åŒ¹é…ç»“æœ
  async saveMatch(mentorId: number): Promise<void> {
    await apiRequest('/api/v1/matching/save', {
      method: 'POST',
      body: JSON.stringify({ mentor_id: mentorId })
    });
  }
}

export const matchingAPI = new MatchingAPI();
```

#### 3. **æ–‡ä»¶ä¸Šä¼  APIå®¢æˆ·ç«¯**

```typescript
// web/app/_lib/file-upload-api.ts
export interface FileUploadResponse {
  file_id: string;
  filename: string;
  original_filename: string;
  file_url: string;
  file_size: number;
  content_type: string;
  uploaded_at: string;
}

class FileUploadAPI {
  // ä¸Šä¼ å¤´åƒ
  async uploadAvatar(file: File): Promise<FileUploadResponse> {
    const formData = new FormData();
    formData.append('file', file);

    const token = getAuthToken();
    const response = await fetch('/api/v1/files/upload/avatar', {
      method: 'POST',
      headers: {
        ...(token && { Authorization: `Bearer ${token}` })
      },
      body: formData
    });

    if (!response.ok) {
      throw new Error('Failed to upload avatar');
    }

    return response.json();
  }

  // ä¸Šä¼ æ–‡æ¡£
  async uploadDocument(
    file: File,
    description?: string
  ): Promise<FileUploadResponse> {
    const formData = new FormData();
    formData.append('file', file);
    if (description) {
      formData.append('description', description);
    }

    const token = getAuthToken();
    const response = await fetch('/api/v1/files/upload/document', {
      method: 'POST',
      headers: {
        ...(token && { Authorization: `Bearer ${token}` })
      },
      body: formData
    });

    if (!response.ok) {
      throw new Error('Failed to upload document');
    }

    return response.json();
  }

  // åˆ é™¤æ–‡ä»¶
  async deleteFile(fileId: string): Promise<void> {
    await apiRequest(`/api/v1/files/${fileId}`, {
      method: 'DELETE'
    });
  }
}

export const fileUploadAPI = new FileUploadAPI();
```

### æ–¹æ¡ˆäºŒï¼šæ›´æ–°APIé…ç½®æ–‡ä»¶

#### æ›´æ–° `web/app/_lib/api-config.ts`

```typescript
export const API_CONFIG = {
  BASE_URL: process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:8000',

  ENDPOINTS: {
    // ç°æœ‰çš„ä¿æŒä¸å˜...

    // ğŸ¤– AIæ™ºèƒ½ä½“ç³»ç»Ÿ v2.0 (æ–°å¢)
    AI_AGENTS_V2: {
      STATUS: '/api/v2/agents/status',
      INFO: '/api/v2/agents/info',
      HEALTH: '/api/v2/agents/health',
      PLANNER_CHAT: '/api/v2/agents/planner/chat',
      CONSULTANT_CHAT: '/api/v2/agents/consultant/chat',
      CHAT: '/api/v2/agents/chat',
      PLANNER_INVOKE: '/api/v2/agents/planner/invoke'
    },

    // ğŸ¯ æ™ºèƒ½åŒ¹é…ç³»ç»Ÿ (æ–°å¢)
    MATCHING: {
      RECOMMEND: '/api/v1/matching/recommend',
      FILTERS: '/api/v1/matching/filters',
      FILTER: '/api/v1/matching/filter',
      HISTORY: '/api/v1/matching/history',
      SAVE: '/api/v1/matching/save',
      SAVED: '/api/v1/matching/saved',
      STATS: '/api/v1/matching/stats',
      COMPATIBILITY: '/api/v1/matching/compatibility'
    },

    // ğŸ“ æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿ (æ–°å¢)
    FILES: {
      UPLOAD_AVATAR: '/api/v1/files/upload/avatar',
      UPLOAD_DOCUMENT: '/api/v1/files/upload/document',
      UPLOAD_GENERAL: '/api/v1/files/upload/general',
      DELETE: (fileId: string) => `/api/v1/files/${fileId}`
    },

    // å®Œå–„ç°æœ‰çš„ç«¯ç‚¹
    MENTORS: {
      // ç°æœ‰çš„ä¿æŒ...
      REGISTER: '/api/v1/mentors/register', // æ–°å¢
      LIST: '/api/v1/mentors', // æ–°å¢
      BY_ID: (id: number) => `/api/v1/mentors/${id}`, // æ–°å¢
      UPDATE: (id: number) => `/api/v1/mentors/${id}`, // æ–°å¢
      SEARCH: '/api/v1/mentors/search',
      PROFILE: '/api/v1/mentors/profile'
    },

    STUDENTS: {
      REGISTER: '/api/v1/students/register', // æ–°å¢
      BY_ID: (id: number) => `/api/v1/students/${id}`, // æ–°å¢
      UPDATE: (id: number) => `/api/v1/students/${id}`, // æ–°å¢
      DELETE: (id: number) => `/api/v1/students/${id}`, // æ–°å¢
      PROFILE: '/api/v1/students/profile'
    },

    SERVICES: {
      CREATE: '/api/v1/services', // æ–°å¢
      LIST: '/api/v1/services', // æ–°å¢
      BY_ID: (id: number) => `/api/v1/services/${id}`, // æ–°å¢
      UPDATE: (id: number) => `/api/v1/services/${id}`, // æ–°å¢
      DELETE: (id: number) => `/api/v1/services/${id}`, // æ–°å¢
      ORDERS: {
        MY_ORDERS: '/api/v1/services/orders/my-orders'
      }
    },

    SESSIONS: {
      CREATE: '/api/v1/sessions', // æ–°å¢
      LIST: '/api/v1/sessions',
      BY_ID: (id: number) => `/api/v1/sessions/${id}`, // æ–°å¢
      UPDATE: (id: number) => `/api/v1/sessions/${id}`, // æ–°å¢
      DELETE: (id: number) => `/api/v1/sessions/${id}`, // æ–°å¢
      STATISTICS: '/api/v1/sessions/statistics'
    },

    REVIEWS: {
      CREATE: '/api/v1/reviews', // æ–°å¢
      LIST: '/api/v1/reviews', // æ–°å¢
      BY_ID: (id: number) => `/api/v1/reviews/${id}`, // æ–°å¢
      UPDATE: (id: number) => `/api/v1/reviews/${id}`, // æ–°å¢
      DELETE: (id: number) => `/api/v1/reviews/${id}`, // æ–°å¢
      MY_REVIEWS: '/api/v1/reviews/my-reviews'
    }
  }
} as const;
```

---

## ğŸ“ **å®æ–½è®¡åˆ’**

### é˜¶æ®µä¸€ï¼šæ ¸å¿ƒåŠŸèƒ½ä¿®å¤ (1-2å¤©)

1. âœ… å®ç°AIæ™ºèƒ½ä½“v2.0 APIå®¢æˆ·ç«¯
2. âœ… æ›´æ–°è®¤è¯å’ŒçŠ¶æ€ç®¡ç†ä»¥æ”¯æŒAIå¯¹è¯
3. âœ… åˆ›å»ºAIå¯¹è¯ç•Œé¢ç»„ä»¶

### é˜¶æ®µäºŒï¼šæ™ºèƒ½åŒ¹é…ç³»ç»Ÿ (2-3å¤©)

1. âœ… å®ç°åŒ¹é…APIå®¢æˆ·ç«¯
2. âœ… åˆ›å»ºåŒ¹é…ç•Œé¢å’Œç»“æœå±•ç¤º
3. âœ… é›†æˆç­›é€‰å’Œä¿å­˜åŠŸèƒ½

### é˜¶æ®µä¸‰ï¼šæ–‡ä»¶ç®¡ç†ç³»ç»Ÿ (1-2å¤©)

1. âœ… å®ç°æ–‡ä»¶ä¸Šä¼ API
2. âœ… åˆ›å»ºæ–‡ä»¶ä¸Šä¼ ç»„ä»¶
3. âœ… é›†æˆå¤´åƒä¸Šä¼ åŠŸèƒ½

### é˜¶æ®µå››ï¼šå®Œå–„å…¶ä»–æ¨¡å— (3-4å¤©)

1. âœ… è¡¥å…¨å¼•è·¯äººå’Œç”³è¯·è€…ç®¡ç†
2. âœ… å®Œå–„æœåŠ¡å’Œä¼šè¯ç®¡ç†
3. âœ… å®ç°è¯„ä»·åé¦ˆç³»ç»Ÿ

---

## ğŸ¯ **ç«‹å³è¡ŒåŠ¨å»ºè®®**

### ä¼˜å…ˆçº§æ’åºï¼š

1. **ğŸ”¥ ç´§æ€¥** - AIæ™ºèƒ½ä½“v2.0æ¥å£ (æ ¸å¿ƒåŠŸèƒ½)
2. **âš¡ é«˜** - æ™ºèƒ½åŒ¹é…ç³»ç»Ÿ (æ ¸å¿ƒä¸šåŠ¡é€»è¾‘)
3. **ğŸ“± ä¸­** - æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿ (ç”¨æˆ·ä½“éªŒ)
4. **ğŸ”§ ä½** - å…¶ä»–æ¨¡å—è¡¥å…¨ (åŠŸèƒ½å®Œå–„)

### æŠ€æœ¯å®æ–½ï¼š

1. å‚è€ƒ [freeCodeCampçš„RESTful APIé›†æˆæŒ‡å—](https://www.freecodecamp.org/news/how-work-with-restful-apis-in-react-simplified-steps-and-practical-examples)
2. ä½¿ç”¨ç°æœ‰çš„TypeScriptå’ŒZustandæ¶æ„
3. ä¿æŒä¸ç°æœ‰APIå®¢æˆ·ç«¯çš„ä¸€è‡´æ€§
4. æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†å’ŒåŠ è½½çŠ¶æ€

### æµ‹è¯•ç­–ç•¥ï¼š

1. å•å…ƒæµ‹è¯•æ¯ä¸ªAPIå®¢æˆ·ç«¯æ–¹æ³•
2. é›†æˆæµ‹è¯•å®Œæ•´çš„ç”¨æˆ·æµç¨‹
3. ç«¯åˆ°ç«¯æµ‹è¯•æ ¸å¿ƒåŠŸèƒ½è·¯å¾„

---

## ğŸ’¡ **é¢å¤–å»ºè®®**

### ä»£ç ç»„ç»‡ä¼˜åŒ–ï¼š

```
web/app/_lib/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ ai-agent-api.ts      # AIæ™ºèƒ½ä½“
â”‚   â”œâ”€â”€ matching-api.ts      # æ™ºèƒ½åŒ¹é…
â”‚   â”œâ”€â”€ file-upload-api.ts   # æ–‡ä»¶ä¸Šä¼ 
â”‚   â”œâ”€â”€ mentor-api.ts        # å¼•è·¯äººç®¡ç†
â”‚   â”œâ”€â”€ student-api.ts       # ç”³è¯·è€…ç®¡ç†
â”‚   â”œâ”€â”€ service-api.ts       # æœåŠ¡ç®¡ç†
â”‚   â””â”€â”€ index.ts             # ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ api-config.ts
â”œâ”€â”€ auth.ts
â””â”€â”€ utils.ts
```

### ç¯å¢ƒé…ç½®ï¼š

```bash
# .env.local
NEXT_PUBLIC_API_BASE_URL=http://localhost:8000
NEXT_PUBLIC_AI_AGENT_TIMEOUT=30000
NEXT_PUBLIC_FILE_UPLOAD_MAX_SIZE=10485760
```

---

**âš¡ æ€»ç»“ï¼šå‰ç«¯æ€¥éœ€å®ç°AIæ™ºèƒ½ä½“v2.0å’Œæ™ºèƒ½åŒ¹é…ç³»ç»Ÿçš„æ¥å£å¯¹æ¥ï¼Œè¿™æ˜¯å¹³å°æ ¸å¿ƒåŠŸèƒ½ï¼**
